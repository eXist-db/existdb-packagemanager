<link rel="import" href="bower_components/polymer/polymer-element.html">

<dom-module id="repo-version">
    <template>
        <style>
            :host {
                display: block;
            }

            button#install {
                display: table-cell;
                padding: 4px;
                margin-left: 10px;
            }

            /*
                  :host:after{
                    content:attr(version);
                  }
            */
        </style>


        <slot></slot>

        <template is="dom-if" if="{{_hasOtherParent()}}">
            <button id="install" on-click="_triggerInstall">Install</button>
        </template>


    </template>

    <script>
        class RepoVersion extends Polymer.Element {

            static get is() {
                return 'repo-version';
            }

            static get properties() {
                return {
                    url: {
                        type: String,
                        reflectToAttribute: true
                    },
                    abbrev: {
                        type: String,
                        reflectToAttribute: true
                    },
                    type: {
                        type: String,
                        reflectToAttribute: true
                    },
                    version: {
                        type: String,
                        reflectToAttribute: true
                    }

                };
            }

            constructor() {
                console.log('ExistdbPackageRemoveAction constructor')
                super();
            }

            connectedCallback() {
                super.connectedCallback();

                if (this._hasOtherParent()) {
//                    this.fire('attachedVersion');
                    this.dispatchEvent(new CustomEvent('attachedVersion', {bubbles: true, composed: true, detail: {}}));

                }
            }

            _hasOtherParent() {
//              console.log('_hasOtherParent ',this.parentNode.nodeName.toLowerCase() == 'repo-other');
                return this.parentNode.nodeName.toLowerCase() == 'repo-other';
            }

            _triggerInstall(e) {
//              console.log('_triggerInstall', this.version);
//                this.fire('requestInstall', {version: this.version});
                this.dispatchEvent(new CustomEvent('requestInstall', {bubbles: true, composed: true, detail: {version: this.version}}));

            }


        }

        window.customElements.define(RepoVersion.is, RepoVersion);

    </script>
</dom-module>
